self.addEventListener("push",e=>{let t;console.log("[Service Worker] Push Received."),console.log(`[Service Worker] Push had this data: "${e.data.text()}"`);try{t=e.data.json()}catch(o){console.error("[Service Worker] Failed to parse push data as JSON."),t={title:"New Update",body:e.data.text(),url:"/"}}const o=t.title||"New Intelligence Alert",i={body:t.body||"New content has been added.",icon:t.icon||"/icons/icon-192x192.png",badge:"/icons/icon-96x96.png",vibrate:[100,50,100],data:{url:t.url||"/"}};e.waitUntil(self.registration.showNotification(o,i))}),self.addEventListener("notificationclick",e=>{console.log("[Service Worker] Notification click Received."),e.notification.close();const t=new URL(e.notification.data.url,self.location.origin).href;e.waitUntil(self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(e=>{if(e.length>0){let o=e[0];for(let t=0;t<e.length;t++)e[t].focused&&(o=e[t]);return o.focus().then(e=>e.navigate(t))}return self.clients.openWindow(t)}))});